export const useAuth = () => {
  const { data, signIn, signOut, status } = useAuth()
  
  const user = computed(() => data.value?.user)
  const loggedIn = computed(() => status.value === 'authenticated')

  const login = async (credentials) => {
    try {
      await signIn('credentials', {
        email: credentials.email,
        password: credentials.password,
        redirect: false
      })
    } catch (error) {
      console.error('Login failed:', error)
      throw error
    }
  }

  const logout = async () => {
    try {
      await signOut({ redirect: false })
    } catch (error) {
      console.error('Logout failed:', error)
      throw error
    }
  }

  return { 
    user, 
    loggedIn, 
    login, 
    logout,
    status: readonly(status)
  }
}